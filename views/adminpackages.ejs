<!DOCTYPE html>
<html lang="en">
  <%- include('partials/head.ejs') %> <%- include('partials/adminnavbar.ejs') %>
  <body class="tms-page">
    <section class="tms-page-header">
      <div class="container">
        <div class="d-flex flex-wrap align-items-center justify-content-between">
          <div>
            <p class="tms-pill d-inline-block mb-2">Admin tools</p>
            <h1 class="mb-1">All Packages</h1>
            <p class="text-muted mb-0">
              Create, edit, and manage every travel package from one place.
            </p>
          </div>
          <a class="btn tms-btn mt-3 mt-lg-0" href="/package/new">
            Create new package
          </a>
        </div>
      </div>
    </section>

    <section class="tms-section">
      <div class="container">
        <% if(messages.length == 1){ %>
        <div class="alert alert-success shadow-sm" role="alert">
          <%= messages %>
        </div>
        <% } %>

        <div class="row">
          <% for (let p of packages){ %>
          <div class="col-lg-6 mb-4">
            <div class="tms-package-card">
              <div class="tms-package-media">
                <img src="<%=p.packageImage%>" alt="<%= p.packageName %>" />
              </div>
              <div class="tms-package-body">
                <div class="d-flex align-items-start justify-content-between">
                  <div>
                    <h4 class="mb-1"><%= p.packageName%></h4>
                    <p class="text-muted mb-2">
                      <%= p.packageLocation %> • <%= p.packageType %>
                    </p>
                  </div>
                  <div class="tms-price">
                    ₹<%= p.packagePrice %>
                    <span class="tms-price-note">per person</span>
                  </div>
                </div>

                <div class="tms-package-meta">
                  <span><strong>Days:</strong> <%= p.days %></span>
                  <span
                    ><strong>Date:</strong>
                    <%= p.startDate.toISOString().substring(0, 10); %></span
                  >
                </div>

                <div class="tms-chip-row">
                  <% for(let f of p.packageFeatures){ %>
                  <span class="tms-chip"><%= f %></span>
                  <% } %>
                </div>

                <div class="tms-admin-actions">
                  <form action="/packages/<%=p._id%>" method="get">
                    <button class="btn tms-btn-outline" type="submit">
                      Open
                    </button>
                  </form>
                  <form action="/packages/<%=p._id%>/edit" method="get">
                    <button class="btn tms-btn-warning" type="submit">
                      Edit
                    </button>
                  </form>
                  <form action="/package/<%=p._id%>?_method=DELETE" method="post">
                    <button class="btn tms-btn-danger" type="submit">
                      Delete
                    </button>
                  </form>
                </div>
              </div>
            </div>
          </div>
          <% } %>
        </div>
      </div>
    </section>
  </body>
</html>
